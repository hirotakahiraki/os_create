     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_load_gdtr
     7 00000000                                 	EXTERN	_asm_inthandler20
     8 00000000                                 	EXTERN	_asm_inthandler21
     9 00000000                                 	EXTERN	_asm_inthandler27
    10 00000000                                 	EXTERN	_asm_inthandler2c
    11 00000000                                 	EXTERN	_load_idtr
    12 00000000                                 [FILE "dsctbl.c"]
    13                                          [SECTION .text]
    14 00000000                                 	GLOBAL	_init_gdtidt
    15 00000000                                 _init_gdtidt:
    16 00000000 55                              	PUSH	EBP
    17 00000001 89 E5                           	MOV	EBP,ESP
    18 00000003 56                              	PUSH	ESI
    19 00000004 53                              	PUSH	EBX
    20 00000005 BE 00270000                     	MOV	ESI,2555904
    21 0000000A BB 00001FFF                     	MOV	EBX,8191
    22 0000000F                                 L6:
    23 0000000F 6A 00                           	PUSH	0
    24 00000011 6A 00                           	PUSH	0
    25 00000013 6A 00                           	PUSH	0
    26 00000015 56                              	PUSH	ESI
    27 00000016 83 C6 08                        	ADD	ESI,8
    28 00000019 E8 0000011D                     	CALL	_set_gatedesc
    29 0000001E 83 C4 10                        	ADD	ESP,16
    30 00000021 4B                              	DEC	EBX
    31 00000022 79 EB                           	JNS	L6
    32 00000024 68 00004092                     	PUSH	16530
    33 00000029 BE 0026F800                     	MOV	ESI,2553856
    34 0000002E 6A 00                           	PUSH	0
    35 00000030 BB 000000FF                     	MOV	EBX,255
    36 00000035 6A FF                           	PUSH	-1
    37 00000037 68 00270008                     	PUSH	2555912
    38 0000003C E8 000000B6                     	CALL	_set_segmdesc
    39 00000041 68 0000409A                     	PUSH	16538
    40 00000046 68 00280000                     	PUSH	2621440
    41 0000004B 68 0007FFFF                     	PUSH	524287
    42 00000050 68 00270010                     	PUSH	2555920
    43 00000055 E8 0000009D                     	CALL	_set_segmdesc
    44 0000005A 83 C4 20                        	ADD	ESP,32
    45 0000005D 68 00270000                     	PUSH	2555904
    46 00000062 68 0000FFFF                     	PUSH	65535
    47 00000067 E8 [00000000]                   	CALL	_load_gdtr
    48 0000006C 58                              	POP	EAX
    49 0000006D 5A                              	POP	EDX
    50 0000006E                                 L11:
    51 0000006E 6A 00                           	PUSH	0
    52 00000070 6A 00                           	PUSH	0
    53 00000072 6A 00                           	PUSH	0
    54 00000074 56                              	PUSH	ESI
    55 00000075 83 C6 08                        	ADD	ESI,8
    56 00000078 E8 000000BE                     	CALL	_set_gatedesc
    57 0000007D 83 C4 10                        	ADD	ESP,16
    58 00000080 4B                              	DEC	EBX
    59 00000081 79 EB                           	JNS	L11
    60 00000083 68 0000008E                     	PUSH	142
    61 00000088 6A 10                           	PUSH	16
    62 0000008A 68 [00000000]                   	PUSH	_asm_inthandler20
    63 0000008F 68 0026F900                     	PUSH	2554112
    64 00000094 E8 000000A2                     	CALL	_set_gatedesc
    65 00000099 68 0000008E                     	PUSH	142
    66 0000009E 6A 10                           	PUSH	16
    67 000000A0 68 [00000000]                   	PUSH	_asm_inthandler21
    68 000000A5 68 0026F908                     	PUSH	2554120
    69 000000AA E8 0000008C                     	CALL	_set_gatedesc
    70 000000AF 83 C4 20                        	ADD	ESP,32
    71 000000B2 68 0000008E                     	PUSH	142
    72 000000B7 6A 10                           	PUSH	16
    73 000000B9 68 [00000000]                   	PUSH	_asm_inthandler27
    74 000000BE 68 0026F938                     	PUSH	2554168
    75 000000C3 E8 00000073                     	CALL	_set_gatedesc
    76 000000C8 68 0000008E                     	PUSH	142
    77 000000CD 6A 10                           	PUSH	16
    78 000000CF 68 [00000000]                   	PUSH	_asm_inthandler2c
    79 000000D4 68 0026F960                     	PUSH	2554208
    80 000000D9 E8 0000005D                     	CALL	_set_gatedesc
    81 000000DE 83 C4 20                        	ADD	ESP,32
    82 000000E1 68 0026F800                     	PUSH	2553856
    83 000000E6 68 000007FF                     	PUSH	2047
    84 000000EB E8 [00000000]                   	CALL	_load_idtr
    85 000000F0 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    86 000000F3 5B                              	POP	EBX
    87 000000F4 5E                              	POP	ESI
    88 000000F5 5D                              	POP	EBP
    89 000000F6 C3                              	RET
    90 000000F7                                 	GLOBAL	_set_segmdesc
    91 000000F7                                 _set_segmdesc:
    92 000000F7 55                              	PUSH	EBP
    93 000000F8 89 E5                           	MOV	EBP,ESP
    94 000000FA 53                              	PUSH	EBX
    95 000000FB 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
    96 000000FE 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    97 00000101 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    98 00000104 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    99 00000107 81 FA 0000FFFF                  	CMP	EDX,65535
   100 0000010D 76 08                           	JBE	L17
   101 0000010F C1 EA 0C                        	SHR	EDX,12
   102 00000112 0D 00008000                     	OR	EAX,32768
   103 00000117                                 L17:
   104 00000117 66 89 13                        	MOV	WORD [EBX],DX
   105 0000011A 88 43 05                        	MOV	BYTE [5+EBX],AL
   106 0000011D 66 89 4B 02                     	MOV	WORD [2+EBX],CX
   107 00000121 C1 EA 10                        	SHR	EDX,16
   108 00000124 C1 F9 10                        	SAR	ECX,16
   109 00000127 C1 E8 08                        	SHR	EAX,8
   110 0000012A 88 4B 04                        	MOV	BYTE [4+EBX],CL
   111 0000012D C1 F9 08                        	SAR	ECX,8
   112 00000130 09 D0                           	OR	EAX,EDX
   113 00000132 88 43 06                        	MOV	BYTE [6+EBX],AL
   114 00000135 88 4B 07                        	MOV	BYTE [7+EBX],CL
   115 00000138 5B                              	POP	EBX
   116 00000139 5D                              	POP	EBP
   117 0000013A C3                              	RET
   118 0000013B                                 	GLOBAL	_set_gatedesc
   119 0000013B                                 _set_gatedesc:
   120 0000013B 55                              	PUSH	EBP
   121 0000013C 89 E5                           	MOV	EBP,ESP
   122 0000013E 53                              	PUSH	EBX
   123 0000013F 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   124 00000142 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   125 00000145 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   126 00000148 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
   127 0000014B 66 89 42 02                     	MOV	WORD [2+EDX],AX
   128 0000014F 88 5A 05                        	MOV	BYTE [5+EDX],BL
   129 00000152 66 89 0A                        	MOV	WORD [EDX],CX
   130 00000155 89 D8                           	MOV	EAX,EBX
   131 00000157 C1 F8 08                        	SAR	EAX,8
   132 0000015A C1 F9 10                        	SAR	ECX,16
   133 0000015D 88 42 04                        	MOV	BYTE [4+EDX],AL
   134 00000160 66 89 4A 06                     	MOV	WORD [6+EDX],CX
   135 00000164 5B                              	POP	EBX
   136 00000165 5D                              	POP	EBP
   137 00000166 C3                              	RET
